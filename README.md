# Social Media Conversion Analysis

Этот проект предназначен для анализа конверсии пользователей в социальной сети. Цель — выявить группы с высокой вовлеченностью, чтобы маркетологи могли эффективно размещать рекламу.

## Структура проекта

1. **Загрузка данных из S3 в Staging**:  
   - DAG `download_files.py` загружает файл `group_log.csv` из S3 в локальную папку `/data`.  
   - Используется библиотека `boto3` для работы с S3 и Apache Airflow для оркестрации задач.

2. **Загрузка данных в Vertica**:  
   - DAG `load_data_to_stg.py` загружает данные из CSV-файла в таблицу `STAGING.group_log` в Vertica.  
   - Учтены особенности типов данных (например, `user_id_from` с пропусками обрабатывается как `Int64`).

3. **Миграция данных в DWH**:  
   - Созданы таблицы в слое DWH:  
     - `l_user_group_activity` (таблица связи).  
     - `s_auth_history` (сателлит для хранения истории событий).  
   - SQL-скрипты для наполнения этих таблиц данными из Staging.

4. **Анализ конверсии**:  
   - Реализованы CTE:  
     - `user_group_messages` — подсчет пользователей, написавших сообщения.  
     - `user_group_log` — подсчет пользователей, вступивших в группы.  
   - Итоговый запрос вычисляет конверсию (`group_conversion`) для 10 самых старых групп.


### Технологии
- Apache Airflow.
- Vertica.
- Python.
- Библиотеки: `boto3`, `pandas`, `sqlalchemy`.

